{% extends "base.html" %}

{%load static %}
{% block title %}Home{% endblock %}
{% block content %}   
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css" />
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>
     
<table class="table" id="home-table" >
    <thead> 
        <tr>
            <th scope="col">Fecha</th>
            <th scope="col">Descripción</th>
            <th scope="col">Valor</th>
            <th scope="col">Categoría</th>
            <th scope="col">Ingreso/Egreso</th>
            <th scope="col">Opciones</th>
        </tr>
    </thead>
    <tbody id="home-table-body" >
    </tbody>
</table>
<!-- <script src="{%static  'js/table.js'%}"></script> -->
<script>    
    async function updateTable(e) {
        const selectType = document.getElementById('transaction_type');
        var selectedType = selectType.value;
        const response = await fetch(`get-table/${selectedType}`)
        const data = await response.json();
        console.log(data)
        var tableBody=document.getElementById('home-table-body')
        tableBody.innerHTML=``;
    
        for(var i in data){
                            var transaction=data[i];
                            tableBody.innerHTML+=`<tr>\
                            <th>${transaction['set_at']}</th>\
                            <td>${transaction['description']}</td>\
                            <td>${transaction['amount']}</td>\
                            <td>${transaction['category']}</td>\
                            <td>${transaction['type']}</td>
                            <td><a href=${"../modify/"+transaction['id']}><i class="fa-solid fa-pen" id="edit_button"></i></a><i class="fa-sharp fa-solid fa-trash"></i></td></tr>`
                            /*ultima  columna  es para  para borrar y modificar, si quieren acceder al id  de la transaccion  deben pedir transaction['id'], 
                            como  está  todo en una tabla  se debe recuperar si  es  Ingreso o Egreso */
                            console.log(transaction['id'])
                        }    
            
        $('#home-table').DataTable();
    }
        </script>
{% endblock content %}
    
    